{% extends 'shahzodspace/base.html' %}


    {% block content %}

    {% block sidebar %}
    {% include 'shahzodspace/sidebar.html' %}
    {% endblock %}

   <!--  Body Wrapper -->
  <div class="page-wrapper" id="main-wrapper" data-layout="vertical" data-navbarbg="skin6" data-sidebartype="full"
  data-sidebar-position="fixed" data-header-position="fixed">
  <!--  Main wrapper -->
  <div class="body-wrapper">
    <h1 class="text-center">Список товаров</h1>
    <div class="container-fluid">
        <!-- Форма поиска -->
        <form method="get" class="form-list w-100">
           <div class="input-group">
               <input type="text" class="form-control" placeholder="Поиск по наименованию..." name="search" value="{{ request.GET.search }}">
               <select name="category" class="form-select">
                   <option value="">Все категории</option>
                   {% for category in categories %}
                       <option value="{{ category.id }}" {% if category.id|stringformat:"s" == current_category %}selected{% endif %}>{{ category.name }}</option>
                   {% endfor %}
               </select>
               <button class="btn btn-outline-secondary" type="submit">Фильтровать</button>
               <a href="{% url 'export_products' %}" class="btn btn-success">Экспорт в Excel</a>
               <a href="{% url 'product_add' %}" class="btn btn-primary">Добавить товар</a>
           </div>
       </form>
       <table style="margin-top: 50px;" class="table">
           <thead>
               <tr>
                   <th>Изображение</th>
                   <th>Номер товара</th>
                   <th>Наименование</th>
                   <th>Категория</th>
                   <th>Модель</th>
                   <th>Количество</th>
                   <th>Цена закупки</th>
                   <th>Цена продажи</th>
                   <th>Действия</th> <!-- Колонка для кнопок действий -->
               </tr>
           </thead>
           <tbody>
               {% for product in products %}
                   <tr>
                       <td><img src="{{ product.photo.url }}" alt="{{ product.name }}" class="product-photo"></td>
                       <td>{{ product.item_number }}</td>
                       <td>{{ product.name }}</td>
                       <td>{{ product.category.name }}</td>
                       <td>{{ product.model }}</td>
                       <td>{{ product.quantity }}</td>
                       <td>{{ product.purchase_price }}</td>
                       <td>{{ product.selling_price }}</td>
                       <td>
                           <!-- Кнопка редактирования -->
                           <a href="{% url 'product_edit' product.id %}" class="btn btn-sm btn-primary"><i class="bi bi-pencil-square"></i></a>
                           <!-- Кнопка удаления -->
                           <form class="m-1" action="{% url 'product_delete' product.id %}" method="post" style="display: inline-block;">
                               {% csrf_token %}
                               <button type="submit" class="btn btn-sm btn-danger"><i class="bi bi-trash3-fill"></i></button>
                           </form>
                           <td>
                               <a href="{% url 'sell_product' product.pk %}" class="btn btn-success"><i class="bi bi-cart-plus-fill"></i></a>
                           </td>
                       </td>
                   </tr>
               {% endfor %}
           </tbody>
       </table>    
      </div>
    </div>
  </div> 

    {% endblock %}

